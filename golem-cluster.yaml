cluster_name: golem-cluster

max_workers: 4

provider:
  type: "external"
  use_internal_ips: true
  module: "golem_ray.client.node_provider.GolemNodeProvider"
  parameters:
    golem_ray_url: "http://localhost:8080"
    image_hash: "0ce63e86c7c7afeee38c2a7282e0f778089eea727d7bc65c82549976"

file_mounts:
  {
      "/home": "/tmp/golem"
  }

available_node_types:
  "ray.head.default":
    max_workers: 0
    resources: {"CPU": 1}
    node_config:
      apiVersion: v1
      kind: Pod
      metadata:
        generateName: ray-head-
        labels:
          component: ray-head
      spec:
        serviceAccountName: autoscaler
        restartPolicy: Never
        volumes:
          - name: dshm
            emptyDir:
              medium: Memory
        containers:
          - name: ray-node
            image: 'rayproject/ray-ml:1.0.1'
            command:
              - /bin/bash
              - '-c'
              - '--'
            args:
              - 'trap : TERM INT; sleep infinity & wait;'
            ports:
              - containerPort: 6379
              - containerPort: 6380
              - containerPort: 6381
              - containerPort: 12345
              - containerPort: 12346
            volumeMounts:
              - mountPath: /dev/shm
                name: dshm
            resources:
              requests:
                cpu: 1000m
                memory: 512Mi
              limits:
                memory: 2Gi
            env:
              - name: MY_CPU_REQUEST
                valueFrom:
                  resourceFieldRef:
                    resource: requests.cpu

setup_commands: []
head_setup_commands: []
worker_setup_commands: []

head_start_ray_commands: ["ray start --head --port 6380 --dashboard-port 8266 --autoscaling-config=~/ray_bootstrap_config.yaml"]
initialization_commands: []
auth:
  ssh_user: 'test'

cluster_synced_files: []
